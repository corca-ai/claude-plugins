# I1-H30 `read-guard` deny/allow 분기

## 목적

`PreToolUse(Read)` 훅에서 파일 크기 기준 `allow[/](/)deny` 분기가 실제로 동작하는지 검증한다.

## 실행 일시

2026-02-19

## 실행 환경

- 실행 스크립트: [read-guard.sh](../../../plugins/cwf/hooks/scripts/read-guard.sh)
- 실행 로그: [project/iter1/artifacts/I1-H30.log](../artifacts/I1-H30.log)

## 재현 명령

```bash
jq -nc --arg p '/tmp/cwf-h30-HXQO/small.txt' '{tool_name:"Read",tool_input:{file_path:$p}}' \
  | bash plugins/cwf/hooks/scripts/read-guard.sh

jq -nc --arg p '/tmp/cwf-h30-HXQO/large.txt' '{tool_name:"Read",tool_input:{file_path:$p}}' \
  | bash plugins/cwf/hooks/scripts/read-guard.sh
```

## 관찰 결과

- Case A (small file, 50 lines): `exit_code=0`, 출력 없음 (`allow`)
- Case B (large file, 2105 lines): `exit_code=0`, `permissionDecision:"deny"` JSON 반환
- deny 사유 핵심: `File has 2105 lines (exceeds 2000-line threshold)`

## 판정

- 상태: PASS
- 결론: `allow[(silent) / ]((silent) / )deny`(JSON) 분기가 의도대로 재현됨.
