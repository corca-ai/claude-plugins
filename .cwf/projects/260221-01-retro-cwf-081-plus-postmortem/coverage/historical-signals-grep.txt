/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/iter2/retro.md:11:1. `cwf:retro --light` 단건 timeout
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/iter2/retro.md:12:2. task 포함 `cwf:run` 단건 timeout
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/iter2/retro.md:17:- timeout 자체 감소보다 먼저 “무엇 때문에 멈췄는지”를 분류기와 로그로 확정하는 것이 반복 속도를 높인다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-04-refactor-review-prevention-hardening/retro.md:17:- The user expects direct root-cause accountability for protocol drift (why it happened, where ambiguity existed, how to prevent recurrence).
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-04-refactor-review-prevention-hardening/retro.md:32:### Waste A — Protocol drift before explicit correction
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-04-refactor-review-prevention-hardening/retro.md:47:  - Why surfaced late? Some failure modes (degraded dependency/fail-open paths) were under-specified in strict tests.
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-04-refactor-review-prevention-hardening/retro.md:67:- Cue: synthesis verdict `Revise` with fail-open and dependency-coverage concerns.
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-04-refactor-review-prevention-hardening/retro.md:86:- Session implication: fail-open behavior in `workflow-gate` had disproportionately high systemic risk despite otherwise strong deterministic coverage.
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-04-refactor-review-prevention-hardening/retro.md:107:- Value: provides standardized persistence semantics that reduce orchestration drift.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/iter1/retro.md:7:  - blocker/timeout 경로 문서화
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/iter1/retro.md:15:1. 설치 blocker와 non-interactive timeout을 재현 가능한 아티팩트로 고정했다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/iter1/retro.md:27:1. CLI 기반 smoke 도구는 "명령 성공 여부"뿐 아니라 "대기 상태(timeout)"를 1급 신호로 분리해야 한다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/iter1/retro.md:34:2. CI에 `check-marketplace-entry` + smoke job 연결(실패 시 릴리스 차단)
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/iter1/retro.md:35:3. `retro`/`run` timeout 원인 추적용 provenance 수집 포인트 추가
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:8:- 이번 회고의 직접 트리거는 사용자 환경에서 `cwf:update`가 `Current=Latest=0.8.2`로 보였지만, 동일 환경에서 `claude plugin update cwf@corca-plugins`는 `0.8.7`까지 정상 업데이트된 불일치다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:9:- post-`0.8.1` 구간(`0.8.2`~`0.8.8`)은 기능 추가와 런타임 하드닝이 매우 빠르게 진행되었고, 안정화 우선순위가 주로 timeout/무출력 잔여 리스크(`K46`, `S10`)에 집중됐다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:31:- 캐시 기반 latest 판정이 실사용 최신 버전과 어긋나 사용자가 수동 `claude plugin update`로 우회.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:34:1. 왜 어긋났나? `latest`를 캐시 파일 탐색 결과로 판정했기 때문이다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:37:4. 왜 게이트가 없었나? 릴리스 위험 관리가 timeout/무출력 안정화에 집중됐다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:38:5. 왜 우선순위가 기울었나? 사용자 체감 정확도 지표(`latest 판정 정합성`)가 별도 추적 지표로 정의되지 않았다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:46:- nested 세션에서 marketplace refresh 불가인데도 cached parity로 사실상 “업데이트 불필요” 인상을 줄 수 있는 출력 경로가 유지됨.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:49:1. 왜 nested 결과가 확정처럼 쓰였나? 상태 모델이 `UP_TO_DATE`/`UNVERIFIED`를 분리하지 않았다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:61:- `Release Metadata Drift` 같은 교훈이 lessons에는 남았지만, 즉시 hard gate로 승격되지 않아 반복 위험이 유지됨.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:90:### CDM 1: `latest_version` 오라클을 캐시 스냅샷으로 고정한 결정
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:94:| **Cues** | `plugins/cwf/skills/update/SKILL.md` Phase 1.3는 `cache_roots`를 순회해 `ls -1dt "$cache_root"/*/cwf/*/.claude-plugin/plugin.json | head -n1` 결과를 `latest_plugin_json`으로 채택한다. 즉, 최신성 판단의 1차 근거가 marketplace manifest가 아니라 로컬 캐시 파일 시각/경로다. |
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:95:| **Goals** | 목표는 (1) scope-aware 업데이트를 유지하면서 (2) 빠르게 `Current version` vs `Latest version`을 비교해 자동 업데이트 여부를 결정하는 것이었다 (`plugins/cwf/skills/update/SKILL.md`). |
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:96:| **Options** | 선택지는 최소 3개였다: A) 캐시 기반 단일 판정(현재 선택), B) 캐시 + 원본 소스(예: marketplace manifest/API) 교차검증, C) 원본 소스 불가 시 `unknown latest`로 fail-closed. |
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:98:| **Situation Assessment** | 사후 증거에서 오판이 확인됐다. `.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro-sections-1-3-summary.md`는 실제 사용자 환경에서 `cwf:update`가 stale한 `Current == Latest`를 출력했지만 direct `claude plugin update`는 성공했다고 기록한다. |
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:100:| **Aiding** | `latest_version` 판정 체크리스트에 “캐시는 후보, 원본은 오라클” 불변식을 추가하고, 불일치 시 종료 코드를 분리(`INCONCLUSIVE`)했어야 한다. |
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:102:**Key lesson**: 업데이트 시스템에서 캐시는 성능 계층이지 진실 계층이 아니다. `latest`는 반드시 authoritative source로 확정하고, 불가하면 성공 판정을 금지해야 한다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:104:### CDM 2: nested 세션에서 marketplace refresh 불가 시에도 캐시 동등값을 최종 결론으로 채택한 결정
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:108:| **Cues** | `.cwf/projects/260219-01-pre-release-audit-pass2/iter2/artifacts/skill-smoke-260219-145730-postfix/12-update_.log`에 `claude plugin marketplace update`가 nested 세션에서 blocked 되며, 그럼에도 `Current version: 0.8.0 / Latest version: 0.8.0 (cached)` 후 `No update needed`가 출력됐다. |
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:110:| **Options** | A) 현재처럼 cached parity로 종료, B) nested에서 refresh 실패 시 즉시 중단 + top-level 재실행 요구, C) 결과 상태를 `unknown`으로 남기고 mutation 금지. |
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:111:| **Basis** | 구현/운영은 연속 실행성(파이프라인 지속)을 우선했다. 그러나 로그 자체가 “marketplace refresh unavailable”을 선언하면서도 최종 결론을 확정해, 불확실성을 성공 케이스로 흡수했다. |
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:112:| **Time Pressure** | 비대화형 smoke 문맥에서는 빠른 판정 압력이 강했다. `.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md`의 여러 항목이 timeout/NO_OUTPUT 대응에 집중된 점도 동일 압력을 뒷받침한다. |
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:114:| **Aiding** | verdict를 `UP_TO_DATE`/`OUTDATED`/`UNVERIFIED` 3상태로 강제하고, `UNVERIFIED`에서는 성공 메시지와 무변경 결론 출력을 금지하는 게이트가 필요하다. |
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:125:| **Tools** | 사용 도구는 artifact gate 스크립트 하나에 집중되었고, update 경로의 oracle 정확성 검증 도구(예: marketplace truth cross-check fixture)는 부재했다. |
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:126:| **Hypothesis** | B 또는 C를 적용했다면 `cwf:update latest-version mismatch`는 post-`0.8.1` 릴리스 체인에서 더 이른 시점에 차단됐을 가능성이 높다. |
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:131:### CDM 4: `Release Metadata Drift` 교훈을 기록했지만 즉시 강제 게이트로 승격하지 않은 결정
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:135:| **Cues** | `.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md`는 `Iteration 2 Lesson — Release Metadata Drift`에서 `plugin.json`과 `.claude-plugin/marketplace.json` 불일치 위험, 그리고 `plugin-deploy` consistency check 필요를 이미 명시했다. |
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:136:| **Goals** | 당시 목표는 다수의 runtime 이슈(timeout, NO_OUTPUT, hook 계약 drift)와 릴리스 진행을 병행 처리하는 것이었다. |
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:138:| **Basis** | `.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro-sections-1-3-summary.md`의 진단처럼 우선순위가 runtime timeout closure(`K46`, `S10`) 쪽으로 기울었고, update 의미론 강화는 후순위가 됐다. |
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:154:이번 세션에서 잘 작동한 부분은, 팀이 반복되는 운영 마찰을 빠르게 패턴화해 결정론적 대응으로 전환했다는 점이다. `lessons.md`에 남은 `Smoke False PASS Hardening`, `Retro Light Deterministic Fast-Path`, `Setup NO_OUTPUT` 대응은 모두 “현장 단서(cues)를 재사용 가능한 실행 규칙으로 압축”한 사례다. 이는 NDM의 강점과 맞닿아 있다. 즉, 완전한 정보가 없어도 팀이 실제 제약(타임아웃, non-interactive 실패 신호)에서 유효한 조치를 빠르게 선택해 파이프라인 연속성을 지켰다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:156:문제는 같은 강점이 update 의미론에서는 약점으로 뒤집혔다는 점이다. `12-update_.log`가 이미 “marketplace refresh unavailable in nested session”을 보여줬는데도 `Current == Latest (cached)`를 최종 결론으로 사용했다. RPD 관점에서 보면, 팀은 익숙한 패턴(캐시 동등값 = 무변경)을 즉시 채택했지만, 핵심 정신 시뮬레이션(“top-level 사용자 환경에서 같은 결론이 유지되는가?”)이 빠졌다. 그 결과 post-`0.8.1` 실제 사용자 경로에서 `cwf:update` stale 판정이 발생했고, 직접 `claude plugin update` 성공이라는 반증 신호가 뒤늦게 나타났다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:158:또 하나의 실패는 “실패 후 학습”이 “다음 릴리스 결정 규칙”으로 승격되지 못한 것이다. `Release Metadata Drift` 교훈은 이미 기록됐지만, update 오라클 정확도(마켓플레이스 진실원천 대조)를 강제하는 하드 게이트로 전환되지 않았다. Klein식으로 말하면, 팀은 경험을 얻었지만 decision requirement(결정 전에 반드시 만족해야 할 검증 조건)를 작업기억 밖의 문서에 남겨두었고, 다음 의사결정 루프에 강제 주입하지 못했다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:161:1. `cwf:update`에 Premortem 게이트를 추가하라: 릴리스 직전 “이미 stale 판정 장애가 발생했다”고 가정하고, 최소 증거 3가지를 통과해야만 `UP_TO_DATE`를 허용한다. (a) top-level에서 marketplace refresh 성공, (b) authoritative manifest와 reported latest 일치, (c) 하나라도 불가하면 `UNVERIFIED`로 fail-closed.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:171:post-`0.8.1` 구간에서 잘된 점도 분명했다. 산출물 게이트와 smoke 흐름은 반복 가능한 절차를 제공해 즉흥 판단을 줄였고, `lessons.md`에 `Release Metadata Drift`를 이미 기록한 것은 이상 징후를 탐지하는 감각이 살아 있었다는 증거다. Kahneman 관점에서 보면, 이는 `System 2`를 보조하는 구조(체크리스트/기록)의 초기 형태를 갖춘 상태였다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:173:실패는 “어려운 질문을 쉬운 질문으로 치환”한 지점에서 발생했다. 실제 질문은 “시장(authoritative source) 기준 최신 버전이 무엇인가?”였는데, 실행은 “로컬 캐시에서 가장 최신 파일이 무엇인가?”로 수렴했다(`retro-sections-1-3-summary.md`, `retro-cdm-analysis.md`). 또 nested 세션에서 marketplace refresh가 막혔는데도 cached 동등값으로 `No update needed`를 확정한 사례는, 1974년 논문이 설명한 “효율적이지만 체계적으로 틀릴 수 있는 휴리스틱”과 동일한 패턴이다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:175:추가로, `0.8.2`~`0.8.8` 연속 릴리스 구간에서 시간압력(런타임 timeout 대응 우선) 하에 캐시 동등값에 높은 확신을 부여한 것은, Kahneman이 경고한 통계적 사고 회피와 과신 편향의 조합으로 해석된다. 즉, 팀은 절차를 운영했지만 “확신의 질”을 검증하는 장치(오라클 교차검증, 불확실성 상태 분리)가 없어 실사용 환경에서만 오판이 드러났다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:178:1. `cwf:update`의 성공 판정 전제에 “authoritative latest 확인”을 하드 게이트로 추가하라. marketplace/API/top-level refresh 확인이 실패하면 `UP_TO_DATE`를 금지하고 `UNVERIFIED`로 종료해 사용자에게 재검증 경로를 강제하라.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:192:- Kahneman 렌즈: 편향 방지용 판정 질문/상태모델(`UNVERIFIED`)을 먼저 강제.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:201:  1. `latest` 판정에 `authoritative source` 확인을 하드 게이트로 추가.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:202:  2. refresh 실패/불확실성은 `UNVERIFIED` 상태로 노출하고 자동 성공판정을 금지.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:207:  - 2주 이상 릴리스/업데이트 로그에서 `UNVERIFIED` 발생 빈도, 오탐/미탐 비율, 사용자 우회율 추세.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:216:  `cwf:update`의 최신 버전 판정을 캐시 스냅샷이 아닌 단일 진실원천(마켓플레이스 매니페스트/서명된 릴리스 메타데이터)으로 고정하는 릴리스 불변식을 추가해야 한다. 또한 릴리스 게이트에 "reported latest == marketplace truth" 검증을 필수 항목으로 넣어 배포 신뢰도를 사전에 보장한다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:238:  - marketplace skill files: 68 (`find ~/.claude/plugins -path '*/skills/*/SKILL.md'`)
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:246:  - release-time semantic validation dedicated to `cwf:update` latest-version truth path
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:252:- Problem signal: update latest-version 판정이 캐시 기반으로 오판 가능.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:253:- Candidate: `plugins/cwf/scripts/check-update-latest-consistency.sh` (신규)
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:273:- Pilot scope: `latest_version` 관련 패턴만 최소 규칙으로 도입
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:316:- 과거 lessons/retro(51개 primary)에서 `drift`, `timeout`, `NO_OUTPUT`, `fail-open` 신호가 반복되는데, 재발 지점은 “문서화된 교훈이 다음 게이트로 승격되지 않는 구간”에 집중된다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:320:- `Release Metadata Drift`가 이전에 기록됐지만, `latest 판정 오라클 정합성` 검증이 release hard gate로 독립되지 않아 재발 허용 창이 남았다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:343:- Evidence: historical corpus 51 files + recurring drift/timeout/fail-open matches (`coverage/historical-signals-grep.txt`).
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:348:- Promotion target: `plugins/cwf/scripts/check-update-latest-consistency.sh` + `scripts/premerge-cwf-gate.sh`
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:351:- Mechanism: `check-update-latest-consistency` 계열 검증을 premerge/predeploy hard gate로 추가하고, 불확실 시 `UNVERIFIED` 상태 강제.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/retro.md:352:- Evidence: 사용자 재현(`cwf:update` 0.8.2 stale vs direct `claude plugin update` 0.8.7 성공), 기존 CDM 1/2 근거.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/lessons.md:10:- **Promotion Target**: `plugins/cwf/scripts/check-update-latest-consistency.sh`
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/lessons.md:12:- **Expected**: `cwf:update` latest-version 판단이 사용자 체감 업데이트 경로와 일치한다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/lessons.md:13:- **Actual**: 캐시 기반 판정이 authoritative source와 불일치할 수 있어 `Current==Latest` 오판이 발생했다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/lessons.md:16:When update latest-version cannot be verified against authoritative marketplace metadata -> return `UNVERIFIED` and block success-style no-update verdicts.
/home/hwidong/codes/claude-plugins/.cwf/projects/260221-01-retro-cwf-081-plus-postmortem/lessons.md:25:- **Actual**: nested 세션 제약(예: marketplace refresh 불가)이 실사용 경로와 달라 오판을 조기에 차단하지 못했다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/lessons.md:14:- **Actual**: 이전 에이전트가 남긴 worktree가 marketplace-v3와 같은 커밋에 있어 브랜치만 새로 생성하여 재활용
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/lessons.md:17:### 외부 CLI 리뷰 timeout과 프롬프트 크기
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/lessons.md:20:- **Actual**: plan.md(239줄) + review-and-prevention.md(270줄) = ~500줄 프롬프트를 stdin으로 전달했더니 Codex/Gemini 모두 120초 timeout (exit 124). Gemini는 credential 로드 + hook 초기화까지만 완료, 실제 응답 생성 시작 안 됨.
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/lessons.md:21:- **Takeaway**: cwf:review의 외부 CLI timeout(120s)은 코드 diff 기준으로 설정됨. plan 리뷰는 spec 문서까지 포함되어 프롬프트가 2-3배 길 수 있음. timeout을 프롬프트 크기/복잡도에 맞춰 적응형으로 조절해야 함.
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/lessons.md:23:When 리뷰 프롬프트 > 300줄이면 → timeout을 180-240초로 확장
/home/hwidong/codes/claude-plugins/.cwf/projects/260218-02-run-portability-contract-hardening/retro.md:7:- Hook SHA marker + sync check made generated-hook drift deterministic.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-03-minimal-smoke-plan/lessons.md:17:게이트 설계 시 → max-failures와 max-timeouts를 분리하여 core 실패와 extended 타임아웃을 구별
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-02-refactor-review-prevention-run/retro.md:10:- Drift check passed after provenance alignment, confirming cross-surface consistency.
/home/hwidong/codes/claude-plugins/.cwf/projects/260220-05-retro-light-5/retro.md:32:- timeout/무출력 재발 시 장시간 분석 단계 전에 스크립트 fail-fast를 먼저 둔다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-02-refactor-review-prevention-run/lessons.md:7:- 훅 수 증가 시 provenance `hook_count`를 즉시 동기화하지 않으면 drift gate가 실패한다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-10-refactor-portability-default/retro.md:28:- Why: avoids drift between repositories and removes optional-compliance ambiguity.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/retro.md:15:- Review stage produced 6 artifacts (`review-*-code.md`) and synthesis (`review-synthesis-code.md`); moderate findings from review were fixed in working tree (`gather` recovery guidance and markdown hook fail-open).
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/retro.md:36:  - 5 Whys root: auth/tool state variability + no strict timeout envelope in wrapper invocation.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/retro.md:37:  - Durable fix: run sync with timeout guard in retro helper and record timeout cause explicitly.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/retro.md:97:  - marketplace skills discovered: 19
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/retro.md:106:  - no timeout wrapper around best-effort session-log sync in orchestrator-level calls
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/retro.md:113:  - timeout wrapper around `sync-session-logs.sh` in retro evidence collection path
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/retro.md:1:# Retro: Prevention Proposals A, B, C, E+G + Adaptive Review Timeout
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/retro.md:7:> Base: marketplace-v3
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/retro.md:11:- CWF 훅 시스템은 두 가지 실패 모드를 사용: **fail-closed** (삭제 안전성, 되돌릴 수 없는 결과) vs **fail-open** (워크플로우 게이트, 프로세스 강제). 결정 기준은 결과의 비가역성.
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/retro.md:17:- `state_version`은 root/session 파일 간 명시적 전파 필요 (독립 bump 시 drift 발생).
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/retro.md:38:- **Why**: review SKILL.md의 timeout 테이블이 >800줄 → 240s로 끝나며, 그 이상은 고려하지 않음
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/retro.md:42:- **메커니즘**: review SKILL.md timeout 테이블에 4번째 행 추가: `> 1200 → skip external CLI (direct Task fallback)`
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/retro.md:73:### CDM-2: Fail-closed/fail-open 비대칭
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/retro.md:75:삭제 안전성은 fail-closed (비가역적 결과), 워크플로우 게이트는 의존성 실패 시 fail-open (세션 마비 방지). 결과 비가역성 기반, API 일관성 기반이 아님. 코드 리뷰에서 비일관성으로 지적(3/6)되었으나 의도적 설계.
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/retro.md:77:**핵심 교훈**: 여러 안전 메커니즘 설계 시 fail-closed vs fail-open을 결과 비가역성과 트리거 빈도에 기반하여 선택. API 일관성이 아님. 비대칭의 근거를 명시적으로 문서화.
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/retro.md:102:2. **Fail-closed/fail-open 비대칭 (Moment 2)**: STAMP의 safety constraint enforcement principle의 올바른 적용. 비대칭 근거가 코드 자체에 문서화되지 않아 향후 유지보수자가 "일관성 수정"으로 control structure를 degradation할 위험.
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/retro.md:110:### Expert β: Sidney Dekker (Drift into Failure)
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/retro.md:113:**출처**: *Drift into Failure* (Ashgate, 2011); *The Field Guide to Understanding 'Human Error'* (CRC Press, 3rd ed., 2014), roster-verified.
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/retro.md:117:1. **상속된 exit-code 결함 (Moment 1)**: 이전 에이전트의 `exit 0` 사용은 단순 버그가 아닌 practical drift — work-as-imagined (JSON `decision` 필드가 차단 제어)와 work-as-done (exit code가 차단 제어) 사이의 격차. 모든 blocking path에서 일관된 오류는 locally coherent misunderstanding의 hallmark. 현재 훅 아키텍처에 이 drift를 구조적으로 방지하는 메커니즘이 없음.
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/retro.md:174:- **Gain**: convention을 structure로 전환, 향후 훅 작성자의 동일 drift 방지
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-03-refactor-review-prevention-impl/retro.md:179:- **Candidate**: review SKILL.md timeout 테이블에 cutoff 행 추가
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-04-full-repo-refactor/retro.md:6:> Branch: marketplace-v3
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-04-full-repo-refactor/retro.md:107:| **Cues** | Deep Review에서 ship SKILL.md에 8개의 하드코딩 값 발견: `Language: Korean`, `marketplace-v3` base branch, 한국어 테이블 헤더, PR 템플릿 내 한국어 리터럴. 다른 12개 스킬은 모두 "user's language" 패턴 사용. |
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-04-full-repo-refactor/retro.md:111:| **Basis** | 옵션 B 선택. 부분 수정은 비일관성을 남김. marketplace-v3는 배포 후 main이 기본. 8개 전부 변경해도 논리 구조 불변. |
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-04-full-repo-refactor/retro.md:160:**Framework**: 실패로의 표류(drift into failure) — 국소적으로 합리적인 결정들의 누적이 시스템을 점진적으로 안전 경계 밖으로 밀어냄
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-04-full-repo-refactor/retro.md:161:**Source**: *Drift into Failure* (Ashgate, 2011)
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-04-full-repo-refactor/retro.md:164:**순간 1 — Ship 스킬의 점진적 환경 고착**: S3→S4.5→현재에 걸쳐 `Language: Korean`이 축적된 과정은 "practical drift"의 전형. 각 결정이 이전 결정과 국소적으로 일관되었기 때문에 합리적으로 보였으나, 이전 결정 자체가 전역 컨벤션에서 이미 이탈. **국소적 일관성이 전역적 비일관성을 은폐.**
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-04-full-repo-refactor/retro.md:180:SSOT 다국어 문서 관리 패턴. 선언적 설정 파일로 소스/파생 언어를 정의하고, CI/CD 게이팅으로 drift를 자동 방지하는 "as code" 패러다임. 세션에서 한국어 SSOT/영어 미러 간 구조 불일치를 수동으로 발견한 경험을 **자동화된 검증 게이트로 발전**시킬 수 있는 방법론. CORCA003의 "자동화 > 문서" 교훈과 일맥상통.
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-04-full-repo-refactor/retro.md:233:- **Expected gain**: 구조 drift 자동 감지
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/iter4/retro.md:32:- timeout/무출력 재발 시 장시간 분석 단계 전에 스크립트 fail-fast를 먼저 둔다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/iter4/retro.md:36:- `I4-K46` direct `cwf:retro --light` timeout(`CLAUDE_EXIT=124`)은 설치/로컬 plugin-dir 경로 모두에서 지속됐다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/iter4/retro.md:37:- `I4-S10` setup full은 `WAIT_INPUT` 비중이 늘었지만 `NO_OUTPUT`(1-byte log) 재발이 남아 runtime 계층 보강이 필요하다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260220-03-retro-light/retro.md:32:- timeout/무출력 재발 시 장시간 분석 단계 전에 스크립트 fail-fast를 먼저 둔다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-04-full-repo-refactor/lessons.md:18:- **Actual**: Language 선언이 한국어로 고정, base branch가 marketplace-v3로 고정, PR 템플릿 변수에 한국어 리터럴 포함
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:43:- **Takeaway**: smoke 분류는 `WAIT_INPUT` + `NO_OUTPUT`를 fail-closed 기본값으로 두고, 신규 문구는 픽스처부터 추가해야 한다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:47:## Iteration 2 Lesson — UserPromptSubmit Contract Drift (2026-02-20)
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:59:## Iteration 2 Lesson — Release Metadata Drift (2026-02-20)
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:61:- **Expected**: 버전 변경 시 `plugin.json`과 `.claude-plugin/marketplace.json`이 항상 동기화된다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:62:- **Actual**: `plugin.json`만 증가하고 marketplace 버전은 유지되어 `cwf:update` 체감과 릴리스 메타데이터가 어긋날 수 있는 상태가 생겼다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:78:- **Actual**: 직접 실행은 timeout이 지속되었지만, deterministic script 경로(`retro-light-fastpath.sh`)는 즉시 `retro.md`를 생성하고 gate를 통과했다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:81:When `--light` 모드가 non-interactive timeout을 반복하면 -> 분석 단계 전 deterministic fast-path 스크립트로 `retro.md`를 먼저 생성하고 gate를 통과시킨다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:86:- **Actual**: `cwf:setup` full에서 빈 출력 종료(`NO_OUTPUT`)가 간헐적으로 발생해 원인 추적이 어려웠다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:93:- direct 재실행에서는 `WAIT_INPUT`이 나와도, smoke spot-check에서 `setup-full`이 간헐적으로 `NO_OUTPUT`로 재발할 수 있다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:106:- **Expected**: `session-map`/`live.worktree_root`가 모두 비는 경계에서도 compact context가 drift 위험을 명시 경고한다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:115:- **Actual**: classifier/문구 보강 후에도 `NO_OUTPUT`(1-byte log) 재발이 남아 있고, 질문형 표현 편차가 존재한다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:118:When setup non-interactive spot-check still shows `NO_OUTPUT` after phrasing hardening -> treat it as runtime-layer gap and prioritize wrapper-level fallback or command-path enforcement over additional phrasing tweaks.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:120:## Iteration 4 Lesson — Direct Retro Timeout Persists Across Local Plugin Path (2026-02-20)
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:122:- **Expected**: `--light` 조기 short-circuit 규약 강화 후 direct `cwf:retro --light` timeout이 완화된다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:126:When direct `cwf:retro --light` keeps timing out even on local plugin path -> rely on deterministic fast-path+gate as authoritative completion path, and track direct runtime timeout separately as known residual risk.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:130:- **Expected**: retrying `cwf:setup` in strict smoke would be enough to eliminate intermittent `NO_OUTPUT`.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:134:When strict runtime smoke still reports `NO_OUTPUT` after bounded retries -> execute a lower-variance setup fallback prompt (for example `cwf:setup --hooks`) and classify based on the fallback result.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/lessons.md:139:- **Actual**: inline `sessions: []` bypassed append logic and created directory/state drift.
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-03-hitl-readme-restart/lessons.md:8:2. Session-log path conventions must be resolver-driven to avoid drift between wrapper/hook/docs.
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-03-hitl-readme-restart/lessons.md:22:4. Generated runtime logs should not silently become commit blockers due policy drift; gate scope must match artifact intent.
/home/hwidong/codes/claude-plugins/.cwf/projects/260219-01-pre-release-audit-pass2/iter3/retro.md:32:- timeout/무출력 재발 시 장시간 분석 단계 전에 스크립트 fail-fast를 먼저 둔다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260217-05-full-skill-refactor-run/retro.md:54:3. Cross-skill canonical references reduced drift and maintenance cost.
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-03-hitl-readme-restart/retro.md:143:**Framework**: 복잡계 안전에서의 `drift into failure`와 New View(인간 오류를 개인 원인이 아니라 시스템 맥락의 신호로 해석)
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-03-hitl-readme-restart/retro.md:144:**Source**: Griffith University Staff Directory (Professor Sidney Dekker) — https://app.griffith.edu.au/phonebook/phone-search.php?format=advanced&surname=Dekker ; Sidney Dekker, *Drift into Failure* (CRC Press, 2011) — https://www.routledge.com/Drift-into-Failure-From-Hunting-Broken-Components-to-Understanding-Complex/Dekker/p/book/9781409422211 ; Sidney Dekker, *The Field Guide to Understanding 'Human Error'* 3rd ed. (CRC Press, 2014) — https://www.routledge.com/The-Field-Guide-to-Understanding-Human-Error/Dekker/p/book/9781472439055 ; Dekker, “Safety after neoliberalism,” *Safety Science* 125 (2020), 104630 — https://doi.org/10.1016/j.ssci.2020.104630
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-03-hitl-readme-restart/retro.md:149:토큰 한계 반복 후 세션 디렉토리를 분기한 결정도 `drift into failure` 관점에서 타당했다. *Drift into Failure*의 핵심처럼, 대형 실패는 대개 “합리적인 일상적 조정”이 누적되며 나타난다. 이 세션의 반복 `token_limit_reached`와 deep-contract 누락은 이미 약한 신호였고, 분기+포인터 전환+즉시 백필은 그 누적 드리프트를 조기 차단한 조치였다. 특히 README.ko SoT 고정 후 전파한 흐름은 맥락 붕괴를 막는 기준점 역할을 했다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-03-hitl-readme-restart/retro.md:154:1. 세션 상태에 `drift signal register`를 추가해 `token_limit_reached`, `needs_follow_up`, 의존성 누락, deep-contract 미충족을 선행지표로 관리하고, 임계치별 강제 동작(예: 즉시 분기, 즉시 설치 질의, 즉시 백필)을 연결한다.
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-03-hitl-readme-restart/retro.md:194:- Marketplace skills (sample, currently installed): `clarify`, `gather-context`, `refactor`, `retro`, `frontend-design`, `plugin-dev/*` 계열.
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-02-hitl-readme/retro.md:148:  - `scripts/check-growth-drift.sh --level warn`
/home/hwidong/codes/claude-plugins/.cwf/projects/260216-02-hitl-readme/retro.md:186:- `check-growth-drift` 변경 의도는 wrapper 신설 스크립트(`post-run-checks.sh`)를 mirror drift 검사에 포함하기 위한 1줄 추가였고, 범위 외로 변형됐던 루트 스크립트는 wrapper 형태로 원복했다.
