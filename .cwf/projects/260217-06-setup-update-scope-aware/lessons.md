# Lessons — setup-update-scope-aware

### 스코프 정책은 설계와 검증 타이밍을 분리해야 함

- **Expected**: 스코프-aware 정책의 방향을 이번 세션에서 확정 가능한 수준으로 정리한다.
- **Actual**: CWF가 아직 메인 마켓플레이스에 배포되지 않아 실제 `cwf@corca-plugins` 기준 E2E 검증은 불가능했다.
- **Takeaway**: 정책(WHAT/WHY)은 선행 설계하고, 기본값/자동화 범위 확정은 배포 후 실환경 검증으로 닫는다.

When 배포 전 상태라 E2E가 불가능하면 → 설계 결정을 “확정/오픈”으로 분리해 기록하고 검증 게이트를 명시한다.

### 동시 작업 세션에서는 live-state 변경을 피해야 함

- **Expected**: 계획 문서만 만들고 다른 실행 세션에는 영향이 없어야 한다.
- **Actual**: live-state helper 호출 시 현재 활성 세션 상태 파일을 건드릴 수 있어 즉시 원복했다.
- **Takeaway**: 동시 리팩토링이 진행 중이면 상태 전이 파일 대신 신규 세션 아티팩트(`plan.md`, `lessons.md`)만 갱신한다.

When 다른 에이전트가 활성 세션을 수행 중이면 → 실행 상태 파일 변경 없이 설계 산출물 파일만 수정한다.
