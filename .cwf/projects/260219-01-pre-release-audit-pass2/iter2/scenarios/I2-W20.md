# I2-W20 compact 이후 worktree 고정 검증

## 목적

`SessionStart(compact)` 이후에도 세션이 원래 worktree에 고정되는지, 그리고 `session_id` 누락 입력에서 우회 가능성이 남아있는지 확인한다.

## 실행 로그

- [.cwf/projects/260219-01-pre-release-audit-pass2/iter2/artifacts/I2-W20-analysis.log](../artifacts/I2-W20-analysis.log)

## 관찰

- `track-user-input.sh --guard-only`는 `session_id`가 있을 때 worktree mismatch를 정상 block.
- 동일 mismatch라도 입력 `session_id`가 비어 있으면 guard가 조기 종료되어 block이 발생하지 않음.
- `compact-context.sh`는 `live.worktree_root` 또는 session-map 정보가 있으면 `[WORKTREE ALERT]`를 출력.
- 하지만 `session_id`도 비고 `live.worktree_root`도 비어 있으면 compact 단계 경고도 사라질 수 있음.

## 판정

- 상태: FAIL(GAP)
- 결론: compact 이후 worktree drift는 특정 조건(`session_id` 공백 + 기대 worktree 메타데이터 부재)에서 재발 가능성이 남아있다.

## 다음 액션

1. `session_id`가 비어도 guard가 최소한 live/session-map 기반으로 검증하는 fallback 설계 검토.
2. `session_id` 공백 케이스를 deterministic hook test에 추가해 회귀 방지.
