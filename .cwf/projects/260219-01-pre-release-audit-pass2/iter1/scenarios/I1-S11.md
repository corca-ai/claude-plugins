# I1-S11 `cwf:setup --hooks` 다중 선택 분기

## 목적

`cwf:setup --hooks`가 신규 repo에서 hook 상태를 읽고 동기화하는지 확인한다.

## 실행 일시

2026-02-19

## 실행 환경

- 샌드박스 레포: [.cwf/projects/260219-01-pre-release-audit-pass2/iter1/sandbox/user-repo-b](../sandbox/user-repo-b)
- 플러그인 로드 방식: `claude --print --plugin-dir /home/hwidong/codes/claude-plugins/plugins/cwf -- <prompt>`

## 실행 A (권한 우회 없음)

```bash
claude --print --plugin-dir ... -- "cwf:setup --hooks ..."
```

### 관찰 A

- 실행은 시작되지만 도구 권한이 없는 모드에서 중단됨
- 메시지 요지: Read/Bash/Edit 권한 거부로 `cwf:setup --hooks` 진행 불가

### 판정 A

- 상태: FAIL (non-interactive 기본 권한 모드에서는 경로 중단)
- 비고: non-interactive 검증 시 `--dangerously-skip-permissions` 또는 적절한 permission mode가 필요

## 실행 B (권한 우회)

```bash
claude --print --dangerously-skip-permissions --plugin-dir ... -- "cwf:setup --hooks ..."
```

### 관찰 B

- `Phase 1` 완료 메시지 반환
- parity check 성공(`CHECK_OK`)
- enabled 8개, disabled 1개(`lint_markdown=false`)로 동기화
- 생성/갱신 확인
  - [.cwf/projects/260219-01-pre-release-audit-pass2/iter1/sandbox/user-repo-b/.cwf/cwf-state.yaml](../sandbox/user-repo-b/.cwf/cwf-state.yaml)
  - `~/.claude/cwf-hooks-enabled.sh`

## 최종 판정

- 상태: PASS (권한 우회 조건부)
- 결론: 스킬 동작 자체는 정상이나, non-interactive 시 permission 정책을 명시하지 않으면 재현이 막힘

## 후속

- `I1-S10`(full setup)도 동일한 permission gating 리스크가 있으므로 동일 조건으로 실행 필요
