## Security Review

### Concerns (blocking)
No blocking concerns identified.

### Suggestions (non-blocking)
- **[S1]** Constrain AskUserQuestion answer extraction to a stricter schema instead of broad regex matching (`select(test("User has answered|user.*answered"))`), so unrelated `tool_result` text is less likely to be persisted into recovery context. Reference: `plugins/cwf/hooks/scripts/log-turn.sh:117`.
- **[S2]** Add explicit max-length guards for persisted `question`/`answer` fields before `journal-append`; retention is count-bounded but not size-bounded, so very large payloads can still bloat state/context. References: `plugins/cwf/hooks/scripts/log-turn.sh:160`, `plugins/cwf/hooks/scripts/log-turn.sh:161`, `plugins/cwf/scripts/cwf-live-state.sh:521`, `plugins/cwf/scripts/cwf-live-state.sh:593`.

### Behavioral Criteria Assessment
- [x] Given hook blocking and allow scenarios / When strict hook tests run / Then each blocking path exits non-zero and each allow path exits zero. — Verified by execution: `bash plugins/cwf/scripts/test-hook-exit-codes.sh --strict` (Summary: total=14, pass=14, fail=0). Assertions are implemented in `plugins/cwf/scripts/test-hook-exit-codes.sh:190`, `plugins/cwf/scripts/test-hook-exit-codes.sh:191`, `plugins/cwf/scripts/test-hook-exit-codes.sh:195`, `plugins/cwf/scripts/test-hook-exit-codes.sh:196`, `plugins/cwf/scripts/test-hook-exit-codes.sh:220`, `plugins/cwf/scripts/test-hook-exit-codes.sh:221`, `plugins/cwf/scripts/test-hook-exit-codes.sh:225`, `plugins/cwf/scripts/test-hook-exit-codes.sh:226`.
- [x] Given parser dedup and /tmp path filtering changes are applied / When path-filter fixtures run / Then false-positive cases are skipped and hazard-relevant cases still block. — Verified by execution: strict suite path-filter checks passed. Parser dedup is implemented via shared live-state readers in `plugins/cwf/hooks/scripts/workflow-gate.sh:44`, `plugins/cwf/hooks/scripts/workflow-gate.sh:50`, `plugins/cwf/hooks/scripts/workflow-gate.sh:115`, `plugins/cwf/hooks/scripts/workflow-gate.sh:131`; /tmp filtering is implemented in `plugins/cwf/hooks/scripts/check-markdown.sh:30`, `plugins/cwf/hooks/scripts/check-shell.sh:30`, `plugins/cwf/hooks/scripts/check-links-local.sh:29`, `plugins/cwf/hooks/scripts/check-deletion-safety.sh:86`.
- [x] Given AskUserQuestion tool_result data is produced / When log-turn processing and compaction/restart simulation run / Then decisions are persisted in live.decision_journal and replay/idempotency rules prevent stale duplicates. — Verified by execution: `bash plugins/cwf/scripts/test-hook-exit-codes.sh --suite decision-journal-e2e` (Summary: total=12, pass=12, fail=0). Persistence path is in `plugins/cwf/hooks/scripts/log-turn.sh:133` and append/idempotency logic in `plugins/cwf/scripts/cwf-live-state.sh:511`.
- [x] Given review prompt line count is 1201+ / When provider routing resolves external slots / Then external CLI slots are skipped and provenance contains cutoff reason and line count. — Verified by execution: `bash plugins/cwf/scripts/check-review-routing.sh --line-count 1199 --line-count 1200 --line-count 1201 --strict` (PASS). Contract and confidence-note evidence are defined in `plugins/cwf/skills/review/SKILL.md:175`, `plugins/cwf/skills/review/SKILL.md:182`, `plugins/cwf/skills/review/SKILL.md:184`, `plugins/cwf/skills/review/SKILL.md:279`.
- [x] Given runtime script references are broken / When script dependency check runs / Then it exits non-zero with broken-edge diagnostics. — Verified by execution: `bash plugins/cwf/scripts/check-script-deps.sh --strict` (PASS on current tree). Non-zero-on-broken behavior is implemented at `plugins/cwf/scripts/check-script-deps.sh:147` and `plugins/cwf/scripts/check-script-deps.sh:153`.
- [x] Given README.ko.md and README.md heading structures diverge / When structure checker runs / Then it exits non-zero with missing/extra/reordered diagnostics. — Verified by execution: `bash plugins/cwf/scripts/check-readme-structure.sh --strict` (PASS on current tree). Divergence diagnostics and strict non-zero behavior are implemented at `plugins/cwf/scripts/check-readme-structure.sh:111`, `plugins/cwf/scripts/check-readme-structure.sh:127`, `plugins/cwf/scripts/check-readme-structure.sh:138`, `plugins/cwf/scripts/check-readme-structure.sh:147`, `plugins/cwf/scripts/check-readme-structure.sh:157`.
- [x] Given review mode code and session logs exist / When synthesis is generated / Then confidence note includes session-log cross-check findings with deterministic field keys. — Implemented in `plugins/cwf/skills/review/SKILL.md:550`, `plugins/cwf/skills/review/SKILL.md:560`, `plugins/cwf/skills/review/SKILL.md:643`, `plugins/cwf/skills/review/SKILL.md:725`.
- [x] Given output-persistence instructions were extracted to shared reference / When conformance checker runs / Then composing skills reference shared instructions and inline duplicate blocks are below threshold. — Verified by execution: `bash plugins/cwf/scripts/check-shared-reference-conformance.sh --strict` (PASS; inline markers at threshold). Shared-reference checks are implemented in `plugins/cwf/scripts/check-shared-reference-conformance.sh:44`, `plugins/cwf/scripts/check-shared-reference-conformance.sh:84`, `plugins/cwf/scripts/check-shared-reference-conformance.sh:97`, `plugins/cwf/scripts/check-shared-reference-conformance.sh:99`.

### Provenance
source: REAL_EXECUTION
tool: claude-task
reviewer: Security
duration_ms: —
command: —
<!-- AGENT_COMPLETE -->
